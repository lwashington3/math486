%! Author = Len Washington III
%! Date = 10/9/24

% Preamble
\documentclass[
	date={October 9{,} 2024},
	month={10},
	day={9}
]{math486notes}

% Document
\begin{document}

\tableofcontents
Given 5 data points $()$

\[ A\vec{x} = x_{1}\vec{v}_{1} + x_{2}\vec{v}_{2} = \vec{b} \]
Defines a place that $\vec{b}$ is not in.
The closest value would be the projection such that $\vec{b} - A\vec{y} \perp A\vec{x}$ where $\vec{y}$ is the least square solution.

\begin{equation}
	\Call{Residual}{} = r(\vec{x}) = b - A\vec{x}
	\label{eq:residual}
\end{equation}
$r=0 \Rightarrow \vec{x}$ is solution $A\vec{x}=\vec{b}$

Measure $\vec{r}$: $||\vec{r}(x)|| = ||\vec{b} - A\vec{x}||$.

Goal $\min ||r(x)||$

Details: $A_{m\times n} \Rightarrow A^{T}_{n\times m}$

\begin{gather}
	(A+B)^{T} = A^{T} + B^{T}\label{eq:transpose-addition}\\
	(AB)^{T} = B^{T}A^{T}\label{eq:transpose-multiplication}
\end{gather}

$\perp \Rightarrow$ orthogonal.

Vectors $\vec{u}$ abd $\vec{v}$ are orthogonal if $\vec{u} \cdot \vec{v} = \vec{u}^{T}\vec{v} = 0$.

\begin{equation*}
\begin{aligned}
	(\vec{b} - A\vec{y}) \perp \{ A\vec{x} | \vec{x} \in \mathbb{R}^{2} \}\\
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
	(A\vec{x}) \cdot (\vec{b} - A\vec{y}) &= 0\\
	(A\vec{x})^{T}(\vec{b} - A\vec{y}) &= 0\\
	\vec{x}^{T}A^{T}(\vec{b} - A\vec{y}) &= 0\\
	A^{T}(\vec{b} - A\vec{y}) &= 0\\
	A^{T}\vec{b} - A^{T}A\vec{y} &= 0\\
	A^{T}_{n\times m}\vec{b} &= A^{T}_{n\times m}A_{m\times n}\vec{y}\\
\end{aligned}
\end{equation*}

\begin{example}
	\[ A = \left[ \begin{array}{cc}
		1 & 1\\
		1 & -1\\
		1 & 1\\
	\end{array} \right],\ \ \vec{b} = \left[ \begin{array}{c}
		2\\
		1\\
		3\\
	\end{array} \right] \]
	$A\vec{v}=\vec{b}$ is inconsistent.
	\begin{equation*}
	\begin{aligned}
		A^{T}A &= \left[ \begin{array}{ccc}
			1 & 1 & 1\\
			1 & -1 & 1\\
		\end{array} \right]\left[ \begin{array}{cc}
			1 & 1\\
			1 & -1\\
			1 & 1\\
	\end{array} \right]
		&= \left[ \begin{array}{cc}
			3 & 1\\
			1 & 3\\
		\end{array} \right]
	\end{aligned}
	\end{equation*}
	\begin{equation*}
	\begin{aligned}
		A^{T}A &= \left[ \begin{array}{ccc}
			1 & 1 & 1\\
			1 & -1 & 1\\
		\end{array} \right]\left[ \begin{array}{c}
			2\\
			1\\
			3\\
	\end{array} \right]
		&= \left[ \begin{array}{cc}
			6\\
			4\\
		\end{array} \right]
	\end{aligned}
	\end{equation*}
	Solve normal equation: $A^{T}Ay=A^{T}b$
	\begin{equation*}
	\begin{aligned}
		\left[ \begin{array}{cc}
			3 & 1\\
			1 & 3
		\end{array} \right]\left[ \begin{array}{c}
			y_{1}\\
			y_{2}
		\end{array} \right] = \left[ \begin{array}{c}
			6\\
			4
		\end{array} \right]
	\end{aligned}
	\end{equation*}
	\begin{equation*}
	\begin{aligned}
		\left[ \begin{array}{cc|c}
			3 & 1 & 6\\
			1 & 3 & 4
		\end{array} \right]
		&= (r_{2} \gets r_{2} - \frac{r_{1}}{3}) \left[ \begin{array}{cc|c}
			3 & 1 & 6\\
			0 & \frac{8}{3} & 2
		\end{array} \right]\\
		&= \left( r_{2} \gets \frac{3}{8}r_{2} \right) \left[ \begin{array}{cc|c}
			3 & 1 & 6\\
			0 & 1 & \frac{3}{4}
		\end{array} \right]\\
		&= \left( r_{1} \gets r_{1} - r_{2} \right) \left[ \begin{array}{cc|c}
			3 & 0 & \frac{25}{4}\\
			0 & 1 & \frac{3}{4}
		\end{array} \right]\\
		&= \left( r_{1} \gets \frac{r_{1}}{3} \right) \left[ \begin{array}{cc|c}
			1 & 0 & \frac{25}{12}\\
			0 & 1 & \frac{3}{4}
		\end{array} \right]\\
	\end{aligned}
	\end{equation*}
\end{example}

Data: $(t_{1}, y_{1}), \dots, (t_{m}, y_{m})$ is the training set.
Formula: $y = a + bt$

\begin{example}
	$(t,y) = (1)$
	\begin{equation*}
	\begin{aligned}
		&a &+& &b(1) &= 2\\
		&a &+& &b(-1) &= 1\\
		&a &+& &b(1) &= 3\\
	\end{aligned}
	\end{equation*}
\end{example}

\begin{equation}
	SSE \Rightarrow r(x) = e_{1}^{2} + e_{2}^{2} + \dots + e_{m}^{2}
	\label{eq:sse}
\end{equation}
\begin{equation}
	RMSE = \sqrt{\frac{SSE}{m}}
	\label{eq:rmse}
\end{equation}

Data points: $\{ (-1, 1), (0, 0), (1, 0), (2, -2) \}$
\begin{example}[Fit to a straight line]
	$y = a + bt$
	\begin{equation*}
	\begin{aligned}
		\left[ \begin{array}{cc}
			1 & -1\\
			1 & 0\\
			1 & 1\\
			1 & 2\\
		\end{array} \right]\left[ \begin{array}{c}
			a\\
			b\\
		\end{array} \right] &= \left[ \begin{array}{c}
			1\\
			0\\
			0\\
			-2\\
		\end{array} \right]\\
		A\vec{x} &= \vec{b}
	\end{aligned}
	\end{equation*}
\end{example}

\begin{example}[Fit to a parabola]
	$y = a + bt + ct^{2}$

\end{example}

\end{document}